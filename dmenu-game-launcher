#!/usr/bin/env python3
# -*- coding: UTF-8 -*-

import json
import os

with open(os.environ['HOME'] + "/.config/dmenu-game-launcher/games.json") as file:
    data = json.load(file)

i = 0
counter = {}
titles = []
for x in data:
    titles.append(x["title"])
    counter[x["title"]] = i
    i += 1

cmd = "echo \"" + "\n".join(sorted(titles)) + "\" | dmenu -i"

option = os.popen(cmd).read()[:-1]

field = counter[option]

executive = data[field]["executive"]

type = data[field]["type"]

if type == "dos":
    cmd = "dosbox -exit " + executive
elif type == "wine":
    cmd = "cd " + os.path.dirname(executive) + " && wine " + os.path.basename(executive)

os.system(cmd)
